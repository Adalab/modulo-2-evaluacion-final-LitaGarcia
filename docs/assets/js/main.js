"use strict";const ul=document.querySelector(".js-ul"),inputTitle=document.querySelector(".js-inputTitle"),searchButton=document.querySelector(".js-searchButton"),SERVER_URL="https://api.jikan.moe/v4/anime?limit=5&q=",defaultImg="https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png",customizedDefaultImg="https://via.placeholder.com/210x295/ffffff/666666/?text=TV",ulFavs=document.querySelector(".js-ulFavs");let animeList=[],favoriteAnimeList=[];const createAnimeCardHtml=(e,t,a)=>{let i=`<li class='cards'><div class='js-card' id='${t}' style="cursor:pointer"><img src='${a}' alt='Portada del anime que has buscado' title='Anime Image'/>`;return i+="<h2>"+e,i+="</div></h2>",i},createAnimeFavCardHtml=e=>createAnimeCardHtml(e.title,e.mal_id,e.images.jpg.image_url)+`<button style="cursor:pointer" class="js-removeFavs data-id=${e.mal_id} buttonRemoveOne"></button></li>`,createAnimeHTML=e=>{let t="";const a=e.images.jpg.image_url,i=a.includes(defaultImg);return t+=createAnimeCardHtml(e.title,e.mal_id,i?customizedDefaultImg:a),t},renderAnimes=()=>{let e="";animeList.forEach(t=>e+=createAnimeHTML(t)),ul.innerHTML=e},addEventListenertoFavs=()=>{document.querySelectorAll(".js-removeFavs").forEach(e=>e.addEventListener("click",removeAnimeFromFav))},renderFavoriteAnimes=()=>{let e="";favoriteAnimeList.forEach(t=>{e+=createAnimeFavCardHtml(t)}),ulFavs.innerHTML=e,document.querySelectorAll(".js-removeFavs").forEach(e=>e.addEventListener("click",removeAnimeFromFav))},addToLocalStorage=()=>{localStorage.setItem("favoritesAnimes",JSON.stringify(favoriteAnimeList))},addAnimeToFav=e=>{const t=animeList.find(t=>e===t.mal_id);-1===favoriteAnimeList.findIndex(e=>e.mal_id===t.mal_id)&&(favoriteAnimeList.push(t),addToLocalStorage(),renderFavoriteAnimes())};function removeAnimeFromFav(e){const t=parseInt(e.currentTarget.dataset.id),a=favoriteAnimeList.find(e=>e.mal_id===t);favoriteAnimeList.splice(a,1),addToLocalStorage(),renderFavoriteAnimes()}const handlefavoriteClick=e=>{const t=parseInt(e.currentTarget.id);addAnimeToFav(t)},addEventListenerToAnimeCards=()=>{document.querySelectorAll(".js-card").forEach(e=>e.addEventListener("click",handlefavoriteClick))},getAnimeDataByTitle=e=>{fetch(`${SERVER_URL}${e}`).then(e=>e.json()).then(e=>{animeList=e.data,renderAnimes(),document.querySelectorAll(".js-card").forEach(e=>e.addEventListener("click",handlefavoriteClick))})},handleClick=e=>{e.preventDefault();const t=inputTitle.value;getAnimeDataByTitle(t)};searchButton.addEventListener("click",handleClick);const getLocalStorage=()=>{const e=JSON.parse(localStorage.getItem("favoritesAnimes"));e&&(favoriteAnimeList=e,renderFavoriteAnimes())};getLocalStorage();const resetButton=document.querySelector(".js-resetButton"),handleClickReset=()=>{animeList=[],renderAnimes()};resetButton.addEventListener("click",handleClickReset);const resetFavsButton=document.querySelector(".js-resetFavs"),handleClickResetFavs=()=>{favoriteAnimeList=[],addToLocalStorage(),renderFavoriteAnimes()};resetFavsButton.addEventListener("click",handleClickResetFavs);